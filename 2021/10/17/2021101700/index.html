<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta content="_IN_R900_oolI5RQXkcge4oNA1j16LtLZH3ej67TyhE" name="google-site-verification"><meta name="referrer" content="no-referrer-when-downgrade"><meta http-equiv="Content-Language" Content="zh-CN"><meta name="description" content="本次配置环境主要涉及三个文件，它们分别是&lt;code&gt;launch.josn&lt;/code&gt;、&lt;code&gt;task.json&lt;/code&gt;和&lt;code&gt;c_cpp_properties.json&lt;/code&gt;。其中，&lt;code&gt;launch.json&lt;/code&gt;主要用于debugger设置，&lt;code&gt;task_json&lt;/code&gt;主要用于编译build设置，而&lt;code&gt;c_cpp_properties.json&lt;/code&gt;主要涉及编译路径设置和IntelliSense设置。"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>Vscode、M1配置C++环境 | deepExplore</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 5.2.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/c/" rel="tag">c++</a> | <a class="post-tag-none-link" href="/tags/mac/" rel="tag">mac</a> | <a class="post-tag-none-link" href="/tags/vscode/" rel="tag">vscode</a></div><div class="post-time">2021-10-17</div></div></div><div class="container post-header"><h1>Vscode、M1配置C++环境</h1><p> <strong>本文作者：</strong>deepMin</p><p> <strong>版权声明：</strong><a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" target="_blank">知识共享协议(署名-非商业性使用-禁止演绎 4.0)</a></p><p><span id="busuanzi_container_page_pv"></span><strong>本文总阅读量： </strong><span id="busuanzi_value_page_pv"></span>次</p></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%E5%92%8C%E6%A3%80%E6%9F%A5%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.</span> <span class="toc-text">第一步：安装插件和检查设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E9%85%8D%E7%BD%AElaunch-json%E5%92%8Ctask-json"><span class="toc-number">2.</span> <span class="toc-text">第二步：配置launch.json和task.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%88%E9%80%89%E5%81%9A%EF%BC%89%EF%BC%9A%E9%85%8D%E7%BD%AEc-cpp-properties-json"><span class="toc-number">3.</span> <span class="toc-text">第三步（选做）：配置c_cpp_properties.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">参考</span></a></li></ol></details></div><div class="container post-content"><p>本次配置环境主要涉及三个文件，它们分别是<code>launch.josn</code>、<code>task.json</code>和<code>c_cpp_properties.json</code>。其中，<code>launch.json</code>主要用于debugger设置，<code>task_json</code>主要用于编译build设置，而<code>c_cpp_properties.json</code>主要涉及编译路径设置和IntelliSense设置。</p>
<h2 id="第一步：安装插件和检查设置"><a href="#第一步：安装插件和检查设置" class="headerlink" title="第一步：安装插件和检查设置"></a>第一步：安装插件和检查设置</h2><p>安装如下插件：</p>
<ul>
<li>C/C++</li>
<li>C++Intellisense</li>
<li>CodeLLDB（Mac M1必须）</li>
</ul>
<p>查看你的Mac中Clang是否安装，使用如下的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> clang --version</span></span><br></pre></td></tr></table></figure>
<p>如果Clang没有安装，那么使用如下的命令进行安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> xcode-select --install</span></span><br></pre></td></tr></table></figure>
<h2 id="第二步：配置launch-json和task-json"><a href="#第二步：配置launch-json和task-json" class="headerlink" title="第二步：配置launch.json和task.json"></a>第二步：配置launch.json和task.json</h2><p>首先，我们先新建一个<code>hello.cpp</code>文件作为测试文件。文件内容如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;hello world&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们按下<code>Fn+F5</code>运行该文件。如果你之前没有配置过，那么vscode会让你进行配置。选择<code>C++ (GDB/LLDB)</code>进行配置。<br><img src="https://static-1259146276.cos.ap-nanjing.myqcloud.com/202110171016686.png"><br>接下来，选择<code>clang++</code>。<br><img src="https://static-1259146276.cos.ap-nanjing.myqcloud.com/202110171019265.png"><br>然后，在<code>.vscode</code>文件中会自动生成<code>launch.json</code>和<code>task.json</code>。</p>
<p>但是这时可以发现虽然生成编译后的文件，但是无法自动在终端中运行。同时在调试控制台出现如下的错误的信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: Unable to start debugging. Unexpected LLDB output from command &quot;-exec-run&quot;. process exited with status -1 (attach failed ((os&#x2F;kern) invalid argument))</span><br></pre></td></tr></table></figure>

<p>另外，在目录中出现了<code>dSYM</code>为结尾的文件夹。该文件夹包含了编译调试信息，显得很烦，我并不希望它生成。</p>
<p>面对如上的情况，所以我们需要对配置文件进行一些修改。</p>
<p>修改：<code>task.json</code></p>
<p>注释<code>-g</code>命令，不再生成编译调试信息。<br>添加<code>-std=c++11</code>，以便以<code>c++11</code>的标准进行编译。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;cppbuild&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;label&quot;</span>: <span class="string">&quot;C/C++: clang++ 生成活动文件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/bin/clang++&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-fdiagnostics-color=always&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-std=c++11&quot;</span>, <span class="comment">// 修改编译标准</span></span><br><span class="line">                <span class="comment">// &quot;-g&quot;, 会生成dsYm文件</span></span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/binary/$&#123;fileBasenameNoExtension&#125;.out&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;options&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;problemMatcher&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$gcc&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;group&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;detail&quot;</span>: <span class="string">&quot;调试器生成的任务。&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;2.0.0&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改：<code>launch.json</code></p>
<p>将<code>type</code>属性修改为<code>lldb</code>。</p>
<p>将<code>stopAtEntry</code>属性修改为<code>true</code>。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用 IntelliSense 了解相关属性。 </span></span><br><span class="line">    <span class="comment">// 悬停以查看现有属性的描述。</span></span><br><span class="line">    <span class="comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;clang++ - 生成和调试活动文件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;lldb&quot;</span>, <span class="comment">// 进行修改</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;fileDirname&#125;/binary/$&#123;fileBasenameNoExtension&#125;.out&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [],</span><br><span class="line">            <span class="attr">&quot;stopAtEntry&quot;</span>: <span class="literal">true</span>, <span class="comment">//改为true</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;environment&quot;</span>: [],</span><br><span class="line">            <span class="attr">&quot;externalConsole&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span>: <span class="string">&quot;lldb&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;preLaunchTask&quot;</span>: <span class="string">&quot;C/C++: clang++ 生成活动文件&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改完毕再次运行，可以看到在终端成功运行。<br><img src="https://static-1259146276.cos.ap-nanjing.myqcloud.com/202110171034526.png"></p>
<h2 id="第三步（选做）：配置c-cpp-properties-json"><a href="#第三步（选做）：配置c-cpp-properties-json" class="headerlink" title="第三步（选做）：配置c_cpp_properties.json"></a>第三步（选做）：配置c_cpp_properties.json</h2><p>在默认的设置中，编译版本使用的是<code>c++98</code>。但是当我们想使用类似<code>auto</code>等c++11高版本特性时，在vscode中会出现红色波浪线。所以我们需要进行一些修改。</p>
<p>在vscode配置终端中（⇧⌘P），使用运行命令<code>C/C++: 编辑配置(JSON)</code>, 会自动生成<code>c_cpp_properties.json</code>。<br><img src="https://static-1259146276.cos.ap-nanjing.myqcloud.com/202110171043651.png"></p>
<p>修改：<code>c_cpp_properties.json</code></p>
<p>修改<code>cppStandard</code>属性为<code>c++11</code>。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Mac&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;includePath&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;$&#123;default&#125;&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;compilerPath&quot;</span>: <span class="string">&quot;/usr/bin/clang&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;cStandard&quot;</span>: <span class="string">&quot;c17&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;cppStandard&quot;</span>: <span class="string">&quot;c++11&quot;</span>, <span class="comment">// 修改为c++11</span></span><br><span class="line">            <span class="attr">&quot;intelliSenseMode&quot;</span>: <span class="string">&quot;macos-clang-arm64&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="number">4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改完成后，就不会出现红色波浪了。</p>
<p>至此，所有配置完成。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://code.visualstudio.com/docs/cpp/config-clang-mac">https://code.visualstudio.com/docs/cpp/config-clang-mac</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos">https://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/67270447/vscode-lldb-on-macos-error-when-starting-debugging-session">https://stackoverflow.com/questions/67270447/vscode-lldb-on-macos-error-when-starting-debugging-session</a></li>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/AskProgramming/comments/og5g8c/how_do_i_turn_off_dsym_files_when_running_c_files/">https://www.reddit.com/r/AskProgramming/comments/og5g8c/how_do_i_turn_off_dsym_files_when_running_c_files/</a></li>
</ul>
</div></div><div class="post-main post-comment"><div id="gitalk-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
const gitalk = new Gitalk({
clientID: 'c764c5e5ccf9d7009356',
clientSecret: '32895acfc04bb0da88a80e60d39aca1d2656a0e0',
repo: 'elfisworking.github.io',      // The repository of store comments,
owner: 'elfisworking',
admin: ['elfisworking'],
id: location.pathname,      // Ensure uniqueness and length less than 50
distractionFreeMode: false  // Facebook-like distraction free mode
})
gitalk.render('gitalk-container') 
</script></div></article><footer class="footer wrapper"><div class="social"><a href="mailto:deepMin@mail.deepexplore.top" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="https://github.com/elfisworking" target="_blank"><i class="fa fa-github"></i></a></div><script async="async" src="//cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js"></script></footer><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>